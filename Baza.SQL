CREATE DATABASE sprehajalecpsov;
USE sprehajalecpsov;


DROP TABLE IF EXISTS KUZA;
DROP TABLE IF EXISTS POSTELJICA;
DROP TABLE IF EXISTS PASMA;
DROP TABLE IF EXISTS SPREHAJALEC;
DROP TABLE IF EXISTS SOBA;
DROP TABLE IF EXISTS HRANJENJE;
DROP TABLE IF EXISTS SPREHOD;
DROP TABLE IF EXISTS UPORABNIKI;

CREATE TABLE UPORABNIKI (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ime VARCHAR(45) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    geslo VARCHAR(255) NOT NULL,
    vloga ENUM('admin', 'user') DEFAULT 'user'
);

CREATE TABLE SPREHAJALEC(
id_sprehajalec INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
ime VARCHAR(45) NOT NULL,
priimek VARCHAR(45) NOT NULL,
datumRojstva DATE NOT NULL,
username VARCHAR(45) NOT NULL,
password VARCHAR (45) NOT NULL
);

CREATE TABLE KUZA(
id_kuza INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
ime VARCHAR(45) NOT NULL,
datumRojstva DATE,
barva VARCHAR(15) NOT NULL,
stCipa INT NOT NULL,
TK_pasma INT NOT NULL,
TK_posteljica INT NOT NULL,
TK_sprehajalec INT NOT NULL,
TK_hranjenje INT NOT NULL,
TK_sprehod INT NOT NULL
);

CREATE TABLE PASMA(
id_pasma INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
pasma VARCHAR(45) NOT NULL
);

CREATE TABLE POSTELJICA(
id_posteljica INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
vrstaPosteljice VARCHAR(45) NOT NULL,
stPosteljice INT NOT NULL,
TK_soba INT NOT NULL
);

CREATE TABLE SOBA(
id_soba INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
stSobe INT NOT NULL,
kapaciteta INT NOT NULL
);

CREATE TABLE HRANJENJE(
id_hranjenje INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
imeHrane VARCHAR(45) NOT NULL,
stObrokov INT NOT NULL,
casPrvegaObroka TIME,
casDrugegaObroka TIME,
casTretjegaaObroka TIME,
casCetrtegaObroka TIME
);

CREATE TABLE SPREHOD(
id_sprehod INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
kolicinaSprehodov INT NOT NULL,
casPrvegaSprehoda TIME,
casDrugegaSprehoda TIME,
casTretjegaSprehoda TIME,
casCetrtegaSprehoda TIME
);

ALTER TABLE POSTELJICA ADD CONSTRAINT TK_posteljica_soba FOREIGN KEY (TK_soba) REFERENCES SOBA (id_soba) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE KUZA ADD CONSTRAINT TK_kuza_posteljica FOREIGN KEY (TK_posteljica) REFERENCES POSTELJICA (id_posteljica) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE KUZA ADD CONSTRAINT TK_kuza_pasma FOREIGN KEY (TK_pasma) REFERENCES PASMA (id_pasma) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE KUZA ADD CONSTRAINT TK_kuza_sprehajalec FOREIGN KEY (TK_sprehajalec) REFERENCES SPREHAJALEC (id_sprehajalec) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE KUZA ADD CONSTRAINT TK_kuza_hranjenje FOREIGN KEY (TK_hranjenje) REFERENCES HRANJENJE (id_hranjenje) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE KUZA ADD CONSTRAINT TK_kuza_sprehod FOREIGN KEY (TK_sprehod) REFERENCES SPREHOD (id_sprehod) ON UPDATE CASCADE ON DELETE RESTRICT;

INSERT INTO PASMA VALUES
(NULL, 'Border Collie'),
(NULL, 'Nemški Ovčar'),
(NULL, 'Pekinezer'),
(NULL, 'Mešanček');

INSERT INTO SOBA VALUES
(NULL, 102, 10),
(NULL, 108, 10),
(NULL, 120, 20);

INSERT INTO SPREHAJALEC VALUES
(NULL, 'Adem', 'Nasufi', '2002-11-07', 'ademn123', 'gesloadem'),
(NULL, 'Nella', 'Zolek', '2004-09-01', 'nellci', 'geslonella'),
(NULL, 'Luffy', 'Monkey', '2000-05-05', 'luffy', 'meat');

INSERT INTO HRANJENJE VALUES 
(NULL, 'Royal Canin', 2, '07:00:00', '17:00:00', NULL, NULL),
(NULL, 'Buddy', 2, '08:00:00', '18:00:00', NULL, NULL),
(NULL, 'Frolic', 3, '09:00:00','14:30:00','19:00:00', NULL);

INSERT INTO SPREHOD VALUES
(NULL, 2, '06:00:00', '16:00:00', NULL, NULL),
(NULL, 2, '07:00:00', '17:00:00', NULL, NULL),
(NULL, 2, '08:00:00', '18:00:00', NULL, NULL);

INSERT INTO POSTELJICA VALUES
(NULL, 'enojna', 1,1),
(NULL, 'enojna', 2,1),
(NULL, 'dvojna', 3,2),
(NULL, 'enojna', 7,3);

INSERT INTO KUZA VALUES
(NULL, 'Fifi', '2010-10-20', 'Bela', 10024, 4,1,1,1,1),
(NULL, 'Rem', '2012-06-22', 'Črna', 10046, 1,2,2,2,2);